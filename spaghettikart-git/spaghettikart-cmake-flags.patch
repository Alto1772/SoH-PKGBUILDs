From 5f6fdc685057d3fa54be96340670ccbbc239ecfa Mon Sep 17 00:00:00 2001
From: AltoXorg <56553686+Alto1772@users.noreply.github.com>
Date: Sun, 10 Aug 2025 13:01:16 +0800
Subject: [PATCH] Readd project compile options

---
 CMakeLists.txt | 51 +++++++++++++++++++++++++++++++++++---------------
 1 file changed, 36 insertions(+), 15 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index c4870b59b..2d55efc2b 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -163,21 +163,21 @@ endif()
 ################################################################################
 # Global configuration types
 ################################################################################
-if (MSVC)
-    set(CMAKE_C_FLAGS_DEBUG "/Od /Zi /DNDEBUG ${COMMON_C_FLAGS}")
-    set(CMAKE_CXX_FLAGS_DEBUG "/Od /Zi /DNDEBUG ${COMMON_CXX_FLAGS}")
-    set(CMAKE_C_FLAGS_RELEASE "/O2 /DNDEBUG ${COMMON_C_FLAGS}")
-    set(CMAKE_CXX_FLAGS_RELEASE "/O2 /DNDEBUG ${COMMON_CXX_FLAGS}")
-else()
-    set(CMAKE_C_FLAGS_DEBUG "-g -DNDEBUG ${COMMON_C_FLAGS}")
-    set(CMAKE_CXX_FLAGS_DEBUG "-g -DNDEBUG ${COMMON_CXX_FLAGS}")
-    set(CMAKE_C_FLAGS_RELEASE "-O3 -DNDEBUG ${COMMON_C_FLAGS}")
-    set(CMAKE_CXX_FLAGS_RELEASE "-O3 -DNDEBUG ${COMMON_CXX_FLAGS}")
-    set(CMAKE_C_FLAGS_MINSIZEREL "-Os -DNDEBUG ${COMMON_C_FLAGS}")
-    set(CMAKE_CXX_FLAGS_MINSIZEREL "-Os -DNDEBUG ${COMMON_CXX_FLAGS}")
-    set(CMAKE_C_FLAGS_RELWITHDEBINFO "-O2 -g -DNDEBUG ${COMMON_C_FLAGS}")
-    set(CMAKE_CXX_FLAGS_RELWITHDEBINFO "-O2 -g -DNDEBUG ${COMMON_CXX_FLAGS}")
-endif()
+#if (MSVC)
+#    set(CMAKE_C_FLAGS_DEBUG "/Od /Zi /DNDEBUG ${COMMON_C_FLAGS}")
+#    set(CMAKE_CXX_FLAGS_DEBUG "/Od /Zi /DNDEBUG ${COMMON_CXX_FLAGS}")
+#    set(CMAKE_C_FLAGS_RELEASE "/O2 /DNDEBUG ${COMMON_C_FLAGS}")
+#    set(CMAKE_CXX_FLAGS_RELEASE "/O2 /DNDEBUG ${COMMON_CXX_FLAGS}")
+#else()
+#    set(CMAKE_C_FLAGS_DEBUG "-g -DNDEBUG ${COMMON_C_FLAGS}")
+#    set(CMAKE_CXX_FLAGS_DEBUG "-g -DNDEBUG ${COMMON_CXX_FLAGS}")
+#    set(CMAKE_C_FLAGS_RELEASE "-O3 -DNDEBUG ${COMMON_C_FLAGS}")
+#    set(CMAKE_CXX_FLAGS_RELEASE "-O3 -DNDEBUG ${COMMON_CXX_FLAGS}")
+#    set(CMAKE_C_FLAGS_MINSIZEREL "-Os -DNDEBUG ${COMMON_C_FLAGS}")
+#    set(CMAKE_CXX_FLAGS_MINSIZEREL "-Os -DNDEBUG ${COMMON_CXX_FLAGS}")
+#    set(CMAKE_C_FLAGS_RELWITHDEBINFO "-O2 -g -DNDEBUG ${COMMON_C_FLAGS}")
+#    set(CMAKE_CXX_FLAGS_RELWITHDEBINFO "-O2 -g -DNDEBUG ${COMMON_CXX_FLAGS}")
+#endif()
 
 # Set game compilation version
 set(VERSION us)
@@ -638,7 +638,28 @@ if (CMAKE_CXX_COMPILER_ID MATCHES "GNU|Clang|AppleClang")
           set(CPU_OPTION -msse2 -mfpmath=sse)
       endif()
 
+      # [PATCH] Readd project compile options
+      # CFLAGS, CXXFLAGS environment vars when defined, gets used instead of CMAKE_C_FLAGS that's defined above
+      # Flags such as critical warnings won't get used due to not being present during compilation
       target_compile_options(${PROJECT_NAME} PRIVATE
+          -Wall -Wextra -Wno-error
+          -Wno-unused-parameter
+          -Wno-unused-function
+          -Wno-unused-variable
+          -Wno-missing-field-initializers
+          -Wno-parentheses
+          -Wno-narrowing
+          -Wno-missing-braces
+          $<$<COMPILE_LANGUAGE:C>:
+            -Wno-int-conversion
+            -Werror-implicit-function-declaration
+            -Wno-incompatible-pointer-types
+          >
+          $<$<COMPILE_LANGUAGE:CXX>:
+            -Wno-c++11-narrowing
+            -Wno-deprecated-enum-enum-conversion
+            -fpermissive -fomit-frame-pointer
+          >
           -pthread
           ${CPU_OPTION}
       )
-- 
2.52.0

